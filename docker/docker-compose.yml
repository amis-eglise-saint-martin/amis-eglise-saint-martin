name: villar

services:
  web:
    build:
      context: ..
      dockerfile: docker/Dockerfile
      args:
        DOMAIN: ${DOMAIN:?DOMAIN is required}
        CONTACT_EMAIL: ${CONTACT_EMAIL:?CONTACT_EMAIL is required}
        CONTACT_PHONE: ${CONTACT_PHONE:?CONTACT_PHONE is required}
        FACEBOOK_URL: ${FACEBOOK_URL:?FACEBOOK_URL is required}
        GITHUB_URL: ${GITHUB_URL:?GITHUB_URL is required}
        FORMSPREE_ID: ${FORMSPREE_ID:-}
        VERSION: ${VERSION:-dev}
        BUILD_MODE: ${BUILD_MODE:-staging}
    image: ${IMAGE:-villar:local}
    container_name: villar
    restart: unless-stopped
    environment:
      - DOMAIN=${DOMAIN:?DOMAIN is required}
    ports:
      - "${PORT:-80}:80"
    volumes:
      - villar-logs:/var/log/nginx
      - villar-data:/data

volumes:
  villar-logs:
  villar-data:
